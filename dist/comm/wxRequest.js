'use strict';

wx.myRequest = function () {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var url = arguments[1];
    var cb = arguments[2];

    var cookie = wx.getStorageSync('cookie');
    var extConfig = wx.getExtConfigSync ? wx.getExtConfigSync() : {};
    console.log("第三方平台数据默认350", extConfig);
    data.kid = extConfig.kid ? extConfig.kid : '412';
    var requestOption = {
        url: url,
        data: data,
        method: data.method ? data.method : "get",
        header: {
            Cookie: ''
        },
        success: function success(res) {
            if (res.header['Set-Cookie']) {
                var regexp = /(PHPSESSID=.*);/;
                var cookie = res.header['Set-Cookie'].match(regexp)[1];
                wx.setStorageSync('cookie', cookie);
            }
            typeof cb == 'function' && cb(res);
        }
    };
    if (cookie) {
        requestOption.header.Cookie = cookie;
    } else {
        delete requestOption.header.Cookie;
    }
    this.request(requestOption);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInd4UmVxdWVzdC5qcyJdLCJuYW1lcyI6WyJ3eCIsIm15UmVxdWVzdCIsImRhdGEiLCJ1cmwiLCJjYiIsImNvb2tpZSIsImdldFN0b3JhZ2VTeW5jIiwiZXh0Q29uZmlnIiwiZ2V0RXh0Q29uZmlnU3luYyIsImNvbnNvbGUiLCJsb2ciLCJraWQiLCJyZXF1ZXN0T3B0aW9uIiwibWV0aG9kIiwiaGVhZGVyIiwiQ29va2llIiwic3VjY2VzcyIsInJlcyIsInJlZ2V4cCIsIm1hdGNoIiwic2V0U3RvcmFnZVN5bmMiLCJyZXF1ZXN0Il0sIm1hcHBpbmdzIjoiOztBQUFBQSxHQUFHQyxTQUFILEdBQWUsWUFBMkI7QUFBQSxRQUFsQkMsSUFBa0IsdUVBQVgsRUFBVztBQUFBLFFBQVJDLEdBQVE7QUFBQSxRQUFKQyxFQUFJOztBQUN0QyxRQUFNQyxTQUFTTCxHQUFHTSxjQUFILENBQWtCLFFBQWxCLENBQWY7QUFDQSxRQUFJQyxZQUFZUCxHQUFHUSxnQkFBSCxHQUFzQlIsR0FBR1EsZ0JBQUgsRUFBdEIsR0FBOEMsRUFBOUQ7QUFDQUMsWUFBUUMsR0FBUixDQUFZLGNBQVosRUFBMkJILFNBQTNCO0FBQ0FMLFNBQUtTLEdBQUwsR0FBV0osVUFBVUksR0FBVixHQUFjSixVQUFVSSxHQUF4QixHQUE0QixLQUF2QztBQUNBLFFBQU1DLGdCQUFnQjtBQUNsQlQsYUFBS0EsR0FEYTtBQUVsQkQsY0FBTUEsSUFGWTtBQUdsQlcsZ0JBQU9YLEtBQUtXLE1BQUwsR0FBWVgsS0FBS1csTUFBakIsR0FBd0IsS0FIYjtBQUlsQkMsZ0JBQVE7QUFDSkMsb0JBQVE7QUFESixTQUpVO0FBT2xCQyxpQkFBUyxpQkFBU0MsR0FBVCxFQUFjO0FBQ25CLGdCQUFJQSxJQUFJSCxNQUFKLENBQVcsWUFBWCxDQUFKLEVBQThCO0FBQzFCLG9CQUFJSSxTQUFTLGlCQUFiO0FBQ0Esb0JBQUliLFNBQVNZLElBQUlILE1BQUosQ0FBVyxZQUFYLEVBQXlCSyxLQUF6QixDQUErQkQsTUFBL0IsRUFBdUMsQ0FBdkMsQ0FBYjtBQUNBbEIsbUJBQUdvQixjQUFILENBQWtCLFFBQWxCLEVBQTRCZixNQUE1QjtBQUNIO0FBQ0QsbUJBQU9ELEVBQVAsSUFBYSxVQUFiLElBQTJCQSxHQUFHYSxHQUFILENBQTNCO0FBQ0g7QUFkaUIsS0FBdEI7QUFnQkEsUUFBSVosTUFBSixFQUFZO0FBQ1JPLHNCQUFjRSxNQUFkLENBQXFCQyxNQUFyQixHQUE4QlYsTUFBOUI7QUFDSCxLQUZELE1BRU87QUFDSCxlQUFPTyxjQUFjRSxNQUFkLENBQXFCQyxNQUE1QjtBQUNIO0FBQ0QsU0FBS00sT0FBTCxDQUFhVCxhQUFiO0FBQ0gsQ0EzQkQiLCJmaWxlIjoid3hSZXF1ZXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsid3gubXlSZXF1ZXN0ID0gZnVuY3Rpb24oZGF0YSA9IHt9LHVybCxjYikge1xyXG4gICAgY29uc3QgY29va2llID0gd3guZ2V0U3RvcmFnZVN5bmMoJ2Nvb2tpZScpO1xyXG4gICAgbGV0IGV4dENvbmZpZyA9IHd4LmdldEV4dENvbmZpZ1N5bmMgPyB3eC5nZXRFeHRDb25maWdTeW5jKCkgOiB7fVxyXG4gICAgY29uc29sZS5sb2coXCLnrKzkuInmlrnlubPlj7DmlbDmja7pu5jorqQzNTBcIixleHRDb25maWcpO1xyXG4gICAgZGF0YS5raWQgPSBleHRDb25maWcua2lkP2V4dENvbmZpZy5raWQ6JzQxMic7XHJcbiAgICBjb25zdCByZXF1ZXN0T3B0aW9uID0ge1xyXG4gICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgbWV0aG9kOmRhdGEubWV0aG9kP2RhdGEubWV0aG9kOlwiZ2V0XCIsXHJcbiAgICAgICAgaGVhZGVyOiB7XHJcbiAgICAgICAgICAgIENvb2tpZTogJydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICBpZiAocmVzLmhlYWRlclsnU2V0LUNvb2tpZSddKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVnZXhwID0gLyhQSFBTRVNTSUQ9LiopOy87XHJcbiAgICAgICAgICAgICAgICB2YXIgY29va2llID0gcmVzLmhlYWRlclsnU2V0LUNvb2tpZSddLm1hdGNoKHJlZ2V4cClbMV07XHJcbiAgICAgICAgICAgICAgICB3eC5zZXRTdG9yYWdlU3luYygnY29va2llJywgY29va2llKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHR5cGVvZiBjYiA9PSAnZnVuY3Rpb24nICYmIGNiKHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGlmIChjb29raWUpIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9uLmhlYWRlci5Db29raWUgPSBjb29raWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRlbGV0ZSByZXF1ZXN0T3B0aW9uLmhlYWRlci5Db29raWU7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlcXVlc3QocmVxdWVzdE9wdGlvbik7XHJcbn07XHJcbiJdfQ==